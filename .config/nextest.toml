# nextest configuration for InferaDB CLI
# See: https://nexte.st/book/configuration.html

[store]
# Directory for storing test artifacts
dir = "target/nextest"

# Default profile configuration
[profile.default]
# Retry failed tests once
retries = 1
# Run tests in parallel
test-threads = "num-cpus"
# Show slow tests
slow-timeout = { period = "60s", terminate-after = 2 }
# Fail fast by default
fail-fast = true

# CI profile - used in GitHub Actions
[profile.ci]
# More retries in CI to handle flaky tests
retries = 2
# Don't fail fast - run all tests to see full picture
fail-fast = false
# Longer timeout for CI environments
slow-timeout = { period = "120s", terminate-after = 3 }
# Generate JUnit XML report for CI integration
junit = { path = "junit.xml" }

# Local development profile
[profile.dev]
# No retries during development
retries = 0
# Fail fast during development
fail-fast = true
# Shorter timeout for faster feedback
slow-timeout = { period = "30s", terminate-after = 1 }

# Coverage profile - used with cargo-llvm-cov
[profile.coverage]
# Single-threaded for accurate coverage
test-threads = 1
# No retries - want accurate failure detection
retries = 0
# Longer timeout for coverage instrumentation overhead
slow-timeout = { period = "180s", terminate-after = 2 }
